import{g as ee}from"./D2BM3cv1.js";import{i as V,p as te,h as Z,U as D,V as ne,b as oe,W as I,X as $,g as K,f as re,Y as H}from"./B11Zin6s.js";import{s as se,f as G}from"./DswakvRO.js";function ae(e){let t=0;try{t=parseInt(e,10)}catch{const o=ce(e);if(V(o))try{t=parseInt(o,10)}catch{}}return t}function ce(e){const t=[];for(let n=0;n<e.length;n++){const o=e.charAt(n),s=parseInt(o,10);isNaN(s)?t.push(o):t.push(s.toString())}return t.join("")}let O,X,S,F,Y,z,W,Q,j,T,u;function ie(e,t,n=void 0){const o=document.createElement("a");return o.classList.add("cursor-pointer"),V(e)&&o.classList.add(e),o.href="javascript:void(0)",o.innerHTML=t.phrase,o.setAttribute("data-start-ref",JSON.stringify(t)),o.setAttribute("data-end-ref",JSON.stringify(n)),o}function le(){S=X.find(e=>e.id===O.collection),F=S.features,W=F["ref-chapter-verse-separator"],Q=F["ref-verse-range-separator"],j=F["ref-verse-list-separator"],T=F["ref-chapter-range-separator"],F["ref-chapter-list-separator"],Y=F["show-scripture-refs"],u=F["ref-extra-material"],V(u)&&(Le(),Se())}function we(e,t,n=""){return O=ee(te),X=Z.bookCollections,z=O.catalog,fe(e,t,n)}function fe(e,t,n=""){le();const o=D(n)?O.book:n,s=O.docSet,r="\\xt "+e+"\\xt*",i="\\\\(\\+?)xt[ \\xA0]([\\s\\S\\xA0]*?)(?:\\|([\\s\\S]*?))?\\\\\\1xt\\*",a=new RegExp(i,"g");let l,v="",c=0;for(;(l=a.exec(r))!==null;){const g=l[2],h=l[3],b=V(h)?h:g,N=V(h)?g:null;let x=W,f=Q;V(h)&&(x=":",f="-");const p=pe(b,s,o,N,x,f,t);v+=r.substring(c,l.index),v+=p,c+=l.index+l[0].length}return v+=r.substring(c),v}function Ee(e,t=null){var r;const o=((r=(t??Z).bookCollections.find(i=>i.id===e.collection).books.find(i=>i.id===e.book))==null?void 0:r.testament)||"";return o==="NT"||o==="OT"||o==="DC"}function pe(e,t,n,o,s,r,i){let a="";if(Y){const l=he(s,r);a=ue(l,e,t,n,o,s,r,i)}else a=e;return a}function ue(e,t,n,o,s,r,i,a){let l=o;const v=new RegExp(e,"g");let c,g="",h="",b=0;for(;(c=v.exec(t))!==null;){const N=oe(c[0]);let x=c[2],f=null;if(!N)if(V(x)){if(f=be(x),l=null,!I(f)&&V(s)){const p=ke(x);V(p)&&(f=p)}}else f=l,x="";if(I(f)){let p="";const E=D(x)?"":x+" ",d=$(c[1]),C=$(c[13]);if(I(c[3])){const m=c[4],R=c[5],w=c[6],M=c[7],k=c[8];K(m),K(M);const P=d+E+m+W+R+w+M+W+k+C,B=y("",n,f,m,M,R,k);p=A(B,s,P,a)}else if(I(c[9])){let m=c[10],R=ae(m),w=$(c[11]);w==="‑"&&i==="-"&&(w="-");let M=c[12];const k=U(f);if(k===1&&(R=1,I(M)?w===i&&(M=m+w+M):M=m,m=""),I(M))if(w===T&&k>1){const P=m+T+M;p=ve(t,s,n,f,E,d,C,P,a)}else w===r||k===1?p=xe(t,s,n,f,E,d,C,m,R,M,r,i,a):p=c[9];else{const P=_(f,m),B=d+E+m+C,q=y("",n,f,m,"","1",P);p=A(q,s,B,a)}}g=p,l=f}else if(N&&V(l)){f=l;const p=re(c[0]),E=U(f);let d="";if(p<=E){const C=p.toString(),m=p.toString(),R=_(f,m),w=y("",n,f,m,"","1",R);d=A(w,s,C,a)}else d=V(s)?s:c[0];g=d}else g=V(s)?s:c[0];h+=t.substring(b,c.index),h+=g,b=c.index+c[0].length}return h+=t.substring(b),h}function he(e,t){const n=V(u)?"("+u+")?":"()",o=e==="."?"\\.":e,s=j==="."?"\\.":j,r="[\\u200f]?",i="(\\d{1,3})",a="\\d{1,3}",l="(\\d{1,3})",v=de();let c=T;c==="-"&&(c=c+"|\\u2011");const g=i+o+l+"("+c+")"+i+o+l;let h=T;if(T!==t){const m=t==="-"?"\\-":t;h=h+"|"+m}(T==="-"||t==="-")&&(h=h+"|\\u2011");const b="(?!(\\d*"+o+"\\d)|(\\d?\\p{Lu})|(\\d?\\s\\p{Lu}))",N=a+b+"(?:"+r+"(?:"+h+")"+a+")?",x="("+N+"(?:"+s+"\\s?"+N+")*)",f="(["+h+o+"])",p=i+"(?:"+r+f+x+")?",E="("+g+")|("+p+")";let d=n+"(?:("+v+")\\s)?(?:"+E+")"+n;return d=d+"(?![^<]*>|[^<>]*</)",d}function de(){let e=Ce();return e=e.replace(/-/g,"\\-"),"(?:[123] )?[\\w\\p{L}][\\w\\p{L}\\p{M}\\s"+e+"]*"}function ge(){const e="\\d{1,3}",t="[\\u200f]?";let n=T;return T==="-"&&(n=n+"\\u2011"),"("+e+")(?:"+t+"["+n+"]("+e+"))?"}function me(e){const t="\\d{1,3}",n="[\\u200f]?";let o=e;return o==="-"&&(o=o+"\\u2011"),"("+t+")(?:"+n+"["+o+"]("+t+"))?"}function be(e){let t,n=0;for(;n<S.books.length;){if(H(S.books[n].name,e)||H(S.books[n].abbreviation,e)||H(S.books[n].abbreviation+".",e)){t=S.books[n].id;break}if(I(S.books[n].additionalNames)){let o=0;for(;o<S.books[n].additionalNames.length;){if(H(S.books[n].additionalNames[o].name,e)){t=S.books[n].id;break}o++}if(I(t))break}n++}return t}function ke(e){let t="",n=0;for(;n<S.books.length;){if(H(S.books[n].id,e)){t=S.books[n].id;break}n++}return t}function U(e){var n;return((n=S.books.find(o=>o.id===e))==null?void 0:n.chapters)||0}function ve(e,t,n,o,s,r,i,a,l){const v=ge();let c=!0,g=0,h=0,b="";const N=new RegExp(v,"g");let x;const f=[];for(;(x=N.exec(a))!==null;)g++,f.push(x);N.lastIndex=0;for(let p=0;p<g;p++){const E=f[p],d=E[1],C=E[2],m=e.includes("‏");let R=d;I(C)&&(m?R=d+"‏"+T+C:R=R+T+C);const w=_(o,d),M=y("",n,o,d,d,"1",w);let k;c?(k=s+R,k=r+k,h==g-1&&(k=k+i),b=A(M,t,k,l),c=!1):(k=R,h==g-1&&(k=k+i),b=b+j+A(M,t,k,l)),h++}return b}function xe(e,t,n,o,s,r,i,a,l,v,c,g,h){let b="",N=0,x=0,f=!0;const p=e.includes("‏"),E=me(g),d=new RegExp(E,"g");let C;const m=[];for(;(C=d.exec(v))!==null;)N++,m.push(C);d.lastIndex=0;for(let R=0;R<N;R++){const w=m[R],M=w[1],k=w[2],P=p;let B=M;I(k)&&(P?B=M+"‏"+g+k:B=B+g+k);const q=y("",n,o,l.toString(),"",M,k);let L="";f?(L=s+a,L=L.trim(),V(B)&&(p&&(L=L+"‏"),D(a)?(L=L+" "+B,L=L.trim()):L=L+c+B),L=r+L,x==N-1&&(L=L+i),b=A(q,t,L,h),f=!1):(L=B,x==N-1&&(L=L+i),b=b+j+A(q,t,L,h)),x++}return b}function A(e,t,n,o){let s="",r=n;V(t)&&(r=t),e.text=r;const i={phrase:e.text,docSet:e.collection,book:e.bookId,chapter:e.fromChapter,verse:e.fromVerse},l=D(e.toChapter)&&D(e.toVerse)?void 0:{phrase:e.text,docSet:e.collection,book:e.bookId,chapter:V(e.toChapter)?e.toChapter:e.fromChapter,verse:V(e.toVerse)?e.toVerse:e.fromVerse};return s=ie(o,i,l).outerHTML,s}function _(e,t,n){if(!t||t==="i")return"0";const r=z.documents.find(l=>l.bookCode===e).versesByChapters[t];if(!r)return"0";const i=Object.keys(r);return i[i.length-1]}function y(e,t,n,o,s,r,i){const a={};return a.text=e,a.collection=t,a.bookId=n,a.fromChapter=o,a.toChapter=s,a.fromVerse=r,a.toVerse=i,a}function Le(){const e=u.split("|"),t=function(o,s){return s.length-o.length};e.sort(t);let n="";e.forEach(function(o,s){s>0&&(n+="|"),n+=o}),u=n}function Se(){u=u.replace("\\","\\\\"),u=u.replace("+","\\+"),u=u.replace(".","\\."),u=u.replace("?","\\?"),u=u.replace("*","\\*"),u=u.replace("^","\\^"),u=u.replace("$","\\$"),u=u.replace("(","\\("),u=u.replace(")","\\)"),u=u.replace("[","\\["),u=u.replace("]","\\]")}function Ce(){const e=new Set;let t=0;for(;t<S.books.length;){const n=S.books[t].name,o=S.books[t].abbreviation,s=S.books[t].additionalNames;let r=I(n)?n.replace(/[\p{L}\p{M}]/gu,""):"";if(J(r,e),r=I(o)?o.replace(/[\p{L}\p{M}]/gu,""):"",J(r,e),I(s)){let i=0;for(;i<s.length;){const a=s[i].name;r=I(a)?a.replace(/[\p{L}\p{M}]/gu,""):"",J(r,e),i++}}t++}return Array.from(e).join("")}function J(e,t){for(let n=0;n<e.length;n++)t.add(e.charAt(n))}async function Ie(e,t,n){console.log("HandleHeaderLinkPressed start: %o end: %o colors: %o",e,t,n);const o=n.PrimaryColor,s=document.createElement("div"),r=document.createElement("div"),i=document.createElement("div"),a=document.createElement("button");i.id="icon";const l=document.createElement("span"),v=document.createElement("span");s.classList.add("flex","flex-row","justify-space-between"),l.classList.add("fr"),v.classList.add("ft"),a.setAttribute("reference",JSON.stringify(e)),a.classList.add("p-2");const c=`<svg fill='${o}' xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h280v80H200v560h560v-280h80v280q0 33-23.5 56.5T760-120H200Zm188-212-56-56 372-372H560v-80h280v280h-80v-144L388-332Z"/></svg>`;return a.innerHTML=c,l.innerText=`${e.phrase} `,v.innerText=await ne(e,t),r.appendChild(l),r.appendChild(v),i.appendChild(a),s.appendChild(r),s.appendChild(i),s.outerHTML}function Be(e,t,n,o){return Me(Z,e,t,n,o)}function Me(e,t,n,o,s){var c;let r="";const i=e.bookCollections.find(g=>g.id===t).features["ref-chapter-verse-separator"],a=e.bookCollections.find(g=>g.id===t).features["ref-verse-range-separator"],l="‏",v=e.bookCollections.find(g=>g.id===t);if(v){const h=v.style.textDirection.toLowerCase()==="rtl",b=se(e,t,n),N=G(b,o.toString()),x=((c=v.books.find(d=>d.id===n))==null?void 0:c.name)||n;h&&(r=" "),r=r+x+" "+N;const[f,p,E]=s[0];if(f>-1){const d=G(b,f.toString());if(h){if(r=r+l+i+d,p>-1){const C=G(b,p.toString());r=r+l+a+C}}else if(r=r+i+d,p>-1){const C=G(b,p.toString());r=r+a+C}}}return r}export{Be as a,we as b,ce as c,ae as g,Ie as h,Ee as i};
